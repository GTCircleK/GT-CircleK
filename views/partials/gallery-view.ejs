<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js"></script>
<script src="assets/js/util.js"></script>
<script>
    $('#gallery').justifiedGallery({
        rowHeight: 200,
        randomize: true,
        margin: 5,
        lastRow: 'justify'
    }).on('jg.complete', function () {
        $('[data-fancybox="gallery"]').fancybox({
            protect: true,
            loop: true,
            closeExiting: false,
            keyboard: true,
            preventCaptionOverlap: true,
            arrows: true,
            infobar: true,
            buttons: ['zoom', 'slideShow', 'fullScreen', 'thumbs', 'close', 'info'],
            animationEffect: 'zoom-in-out',
            transitionEffect: 'fade',
            afterLoad: function (instance, current) {
                var pixelRatio = window.devicePixelRatio || 1;

                if (pixelRatio > 1.5) {
                    current.width = current.width / pixelRatio;
                    current.height = current.height / pixelRatio;
                }
            }
        });
    });
</script>